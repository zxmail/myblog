<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="description" content="{{- meta_description -}}">
    <title>{{- meta_title -}}</title>
    <link rel="stylesheet" href="{{ &OPT.theme_github_path }}JustNews/files/style.css?v=1.3.9">
    <link rel="stylesheet" href="{{ &OPT.theme_github_path }}JustNews/files/swiper.min.css">
    <link rel="stylesheet" href="{{ &OPT.theme_github_path }}JustNews/files/fonts/fontawesome5pro-all.min.css">
    <link rel="shortcut icon" href="{{ &OPT.theme_github_path }}JustNews/admin/files/favicon.ico">
    <script src="{{ &OPT.theme_github_path }}JustNews/admin/files/jquery.min.js"></script>
    <script src="{{ &OPT.theme_github_path }}JustNews/files/swiper.min.js"></script>
    {{- head_html -}}
</head>

<body class="m-flex">
    <header class="site-header">
        <div class="header-container">
            <div class="mobile-menu-toggle"><i class="fas fa-bars"></i></div>
            <div class="header-left">
                <div class="logo-area">
                    <a href="/" class="logo-link">
                        <img src="{{ &OPT.theme_github_path }}JustNews/files/logo.png" alt="{{- blog_name -}}" class="logo-image">
                        <span class="blog-name">{{- blog_name -}}</span>
                    </a>
                </div>
            </div>
            <nav class="main-nav">
                <div class="mobile-nav-header">
                     <img src="{{ &OPT.theme_github_path }}JustNews/files/mobile-header.svg" alt="Mobile Menu Header" class="mobile-nav-header-image">
                </div>
                <div class="close-menu-btn">&times;</div>
                {{- navigation_html -}}
            </nav>
            <div class="header-right">
                <div class="search-icon"><i class="fas fa-search"></i></div>
                {{- if login_html -}}
                    <div class="login-link">
                        {{- login_html -}}
                    </div>
                {{- endif -}}
            </div>
        </div>
    </header>

    <div id="wrap">
        <div class="container">
            {{- if is_index -}}
            <div class="carousel-container">
                <div class="swiper">
                    <div class="swiper-wrapper">
                        <div class="swiper-slide"><a href="#" target="_blank"><img src="https://www.iplaysoft.com/wp-content/uploads/2024/05/robotac-1200.jpg" /></a></div>
                        <div class="swiper-slide"><a href="#" target="_blank"><img src="https://www.iplaysoft.com/wp-content/uploads/2024/05/robotac-1200.jpg" /></a></div>
                        <div class="swiper-slide"><a href="#" target="_blank"><img src="https://www.iplaysoft.com/wp-content/uploads/2024/05/robotac-1200.jpg" /></a></div>
                    </div>
                    <div class="swiper-pagination"></div>
                    <div class="swiper-button-prev"></div>
                    <div class="swiper-button-next"></div>
                </div>
            </div>
            {{- endif -}}

            <div class="main-layout">
                <div class="main-content left-column">
                    <div class="article-list">
                        {{- articles_html -}}
                    </div>
                    <div class="pagination">
                        {{- pagination_html -}}
                    </div>
                </div>

                <aside class="right-column">
                    {{- sidebar_html -}}
                </aside>
            </div>
            <div class="friend-links">
                <div class="widget-title">友情链接</div>
                <div class="links-container">
                    {{- friend_links_html -}}
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
        {{- footer_html -}}
    </footer>

    <div class="action">
        <div class="action-item gotop" id="gotop" style="display: none;"><i class="fa fa-chevron-up"></i></div>
    </div>
    <div class="overlay"></div>

    <div class="search-popup">
        <div class="search-popup-container">
            <form class="search-form" id="search-form" action="/search" method="get" accept-charset="utf-8" target="_blank">
                <i class="fas fa-search search-icon-inside"></i>
                <input name="q" type="text" placeholder="输入关键词搜索..." autocomplete="off">
                <div class="search-close">&times;</div>
            </form>
        </div>
    </div>


    <script>
    $(document).ready(function() {
        // 返回顶部
        $(window).scroll(function() {
            if ($(window).scrollTop() > 200) {
                $('#gotop').fadeIn(300);
            } else {
                $('#gotop').fadeOut(300);
            }
        });
        $('#gotop').click(function() {
            $('html,body').animate({
                scrollTop: '0px'
            }, 300);
        });

        // 移动端菜单
        $('.mobile-menu-toggle').click(function() {
            $('body').addClass('nav-open');
        });

        $('.close-menu-btn, .overlay').click(function() {
            $('body').removeClass('nav-open');
            $('.main-nav .sub-menu').slideUp();
            $('.main-nav .submenu-toggle').removeClass('active');
        });

        // 多级菜单
        $('.main-nav .submenu-toggle').click(function(e) {
            e.preventDefault();
            $(this).toggleClass('active');
            $(this).next('.sub-menu').slideToggle();
        });

        // Swiper
        const swiper = new Swiper('.swiper', {
            loop: true,
            autoplay: {
                delay: 5000,
                disableOnInteraction: false,
            },
            pagination: {
                el: '.swiper-pagination',
                clickable: true,
            },
            navigation: {
                nextEl: '.swiper-button-next',
                prevEl: '.swiper-button-prev',
            },
        });
        
        // 搜索弹出层控制
        $('.search-icon').on('click', function(e) {
            e.preventDefault();
            $('.search-popup').addClass('is-visible');
            setTimeout(function() {
                $('.search-popup input[name="q"]').focus();
            }, 100);
        });

        $('.search-popup').on('click', '.search-close', function(e) {
            e.preventDefault();
            $('.search-popup').removeClass('is-visible');
        });

        $(document).on('keyup', function(e) {
            if (e.key === "Escape") {
                $('.search-popup').removeClass('is-visible');
            }
        });

    });
    </script>
</body>
</html>
