<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width,viewport-fit=cover">
    <title>{{ &title }}</title>
    <meta name="keywords" content="{{ &keywords }}" />
    <meta name="description" content="{{ &description }}" />

    <link rel="stylesheet" href="{{ &OPT.theme_github_path }}JustNews/files/swiper.min.css"/>
    <link rel='stylesheet' href='{{ &OPT.theme_github_path }}JustNews/files/fonts/fontawesome5pro-all.min.css'>
    <link rel='stylesheet' href='{{ &OPT.theme_github_path }}JustNews/files/style.css'>
    <link rel='stylesheet' href='{{ &OPT.theme_github_path }}JustNews/files/noto+serif.css' type='text/css' media='all' />
	<link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="/atom.xml">
	<link rel="shortcut icon" href="{{& OPT.theme_github_path}}JustNews/files/logo2.png" type="image/x-icon">
	{{& OPT.codeBeforHead}}
</head>
<body class="m-flex">
	<header class="site-header">
    <div class="header-container">
        <div class="mobile-menu-toggle" id="mobile-menu-toggle">
            <i class="fal fa-bars"></i>
        </div>
        <div class="header-left">
            <div class="logo-area">
                {{ #OPT.logo }}
                <a href="/"><img src="{{ &OPT.logo }}" alt="博客Logo" class="logo-image"></a>
                {{ /OPT.logo }}
                {{ #OPT.showSiteNameInHeader }}
                <a href="/" class="blog-name">{{ &OPT.siteName }}</a>
                {{ /OPT.showSiteNameInHeader }}
            </div>
            <nav class="main-nav" id="main-nav">
                <div class="close-menu-btn" id="close-menu-btn">&times;</div>

                <div class="mobile-nav-header">
                    <img src="{{ &OPT.theme_github_path }}JustNews/files/mobile-header.svg" alt="导航背景" class="mobile-nav-header-image">
                </div>

                <ul>
                    {{ #OPT.widgetMenuList }}
                    <li>
                        <a href="{{ &url }}">
                            {{ #icon }}<i class="{{ &icon }}" style="margin-right: 5px;"></i> {{ /icon}}{{ &name }}
                            {{! 使用我们新的、清晰无误的 hasChildren 标记来判断 }}
                            {{ #hasChildren }}
                            <span class="arrow-container"><i class="fal fa-angle-down"></i></span>
                            {{ /hasChildren }}
                        </a>
                        {{ #hasChildren }}
                        <span class="submenu-toggle"><i class="fal fa-angle-right"></i></span>
                        {{ /hasChildren }}

                        {{ #hasChildren }}
                        <ul class="sub-menu">
                            {{ #children }}
                            <li>
                                <a href="{{ &url }}">
                                    {{ #icon }}<i class="{{ &icon }}" style="margin-right: 5px;"></i> {{ /icon}}{{ &name }}
                                    {{ #hasChildren }}
                                    <span class="arrow-container"><i class="fal fa-angle-right"></i></span>
                                    {{ /hasChildren }}
                                </a>
                                {{ #hasChildren }}
                                <span class="submenu-toggle"><i class="fal fa-angle-right"></i></span>
                                {{ /hasChildren }}

                                {{ #hasChildren }}
                                <ul class="sub-menu">
                                    {{ #children }}
                                    <li>
                                        <a href="{{ &url }}">
                                            {{ #icon }}<i class="{{ &icon }}" style="margin-right: 5px;"></i> {{ /icon}}{{ &name }}
                                        </a>
                                    </li>
                                    {{ /children }}
                                </ul>
                                {{ /hasChildren }}
                            </li>
                            {{ /children }}
                        </ul>
                        {{ /hasChildren }}
                    </li>
                    {{ /OPT.widgetMenuList }}
                     <li class="login-btn-mobile">
                         <a href="/admin">
                             <button class="login-btn-header">登录</button>
                         </a>
                     </li>
                </ul>
            </nav>
            </div>

        <div class="header-right">
            <div class="search-icon" id="search-toggle">
                <i class="fal fa-search"></i>
            </div>
             <a href="/admin" class="login-link">
                 <i class="fal fa-user-circle"></i>
             </a>
        </div>
    </div>

	<div class="search-box-container" id="search-box">
        <input type="text" placeholder="输入关键词搜索..." class="search-input">
        <button class="search-button">搜索</button>
        <i class="far fa-chevron-double-up" id="close-search-btn" title="收起"></i>
    </div>
</header>
    <div id="wrap" class="container">
        <div class="main-layout">
            <div class="left-column post-article">
                <article>
                    {{#article.firstImageUrl}}
                    <div class="article-featured-image" style="background-image: url('{{article.firstImageUrl}}');"></div>
                    {{/article.firstImageUrl}}

                    <div class="entry-card">
                        <header class="entry-head">
                            <h1 class="entry-title">{{article.title}}</h1>
                            <div class="entry-info">
                                <span class="entry-date"><i class="fal fa-calendar-alt"></i>{{article.createDate10}}</span>
                                <span class="dot">&middot;</span>
                                <span class="entry-category"><i class="fal fa-folder"></i>
                                    {{#article.category}}
                                    <a href="/category/{{.}}/">{{.}}</a>
                                    {{/article.category}}
                                </span>
                                <span class="dot">&middot;</span>
                                <span class="entry-views"><i class="fal fa-eye"></i>{{article.views}}</span>
                            </div>
                        </header>
                        
                        <div class="entry-content">
                            {{{article.content}}}
                        </div>

                        <footer class="entry-footer">
                            <div class="entry-tag">
                                <i class="fal fa-tags"></i>
                                <a href="#">示例标签</a>
                                <a href="#">Cloudflare</a>
                            </div>
                            <nav class="entry-page">
                                {{#prevArticle}}
                                <a href="{{url}}" class="entry-page-prev">
                                    <span class="page-arrow">上一篇</span>
                                    <span class="page-title">{{title}}</span>
                                </a>
                                {{/prevArticle}}
                                {{^prevArticle}}
                                <a class="entry-page-prev">
                                    <span class="page-arrow">上一篇</span>
                                    <span class="page-title">没有了</span>
                                </a>
                                {{/prevArticle}}

                                {{#nextArticle}}
                                <a href="{{url}}" class="entry-page-next">
                                    <span class="page-arrow">下一篇</span>
                                    <span class="page-title">{{title}}</span>
                                </a>
                                {{/nextArticle}}
                                {{^nextArticle}}
                                <a class="entry-page-next">
                                    <span class="page-arrow">下一篇</span>
                                    <span class="page-title">没有了</span>
                                </a>
                                {{/nextArticle}}

                            </nav>
                        </footer>
                    </div>
                </article>

                <div id="comments" class="entry-card">
                     <h3 class="widget-title">评论</h3>
                     <p>暂无评论</p>
                </div>
            </div>

            <aside class="right-column">
                <div class="sidebar-sticky-wrapper">
                    <div class="widget widget-recent-posts">
                        <h3 class="widget-title">热门文章</h3>
                        <ul>
                            {{#widgetRecentlyList}}
                            <li class="recent-article-item-box">
                                {{#firstImageUrl}}
                                <div class="recent-article-item-image">
                                    <a href="{{url}}">
                                        <img src="{{firstImageUrl}}" alt="{{title}}">
                                    </a>
                                </div>
                                {{/firstImageUrl}}
                                <div class="recent-article-item-content">
                                    <a href="{{url}}">{{title}}</a>
                                    <span class="recent-article-item-date">{{createDate10}}</span>
                                </div>
                            </li>
                            {{/widgetRecentlyList}}
                        </ul>
                    </div>

                    <div class="widget widget-categories">
                        <h3 class="widget-title">分类目录</h3>
                        <ul>
                            {{#widgetCategoryList}}
                            <li><a href="/category/{{name}}/"> <i class="{{icon}}"></i> {{name}}</a></li>
                            {{/widgetCategoryList}}
                        </ul>
                    </div>

                    <div class="widget widget-tags">
                        <h3 class="widget-title">标签</h3>
                        <div class="tag-cloud">
                            <a href="#">示例标签</a>
                            <a href="#">Cloudflare</a>
                            <a href="#">Workers</a>
                            <a href="#">Blog</a>
                        </div>
                    </div>

                    <div class="widget widget-comments">
                        <h3 class="widget-title">最近评论</h3>
                        <ul>
                            <li>暂无评论</li>
                        </ul>
                    </div>
                </div>
            </aside>
        </div>
    </div>

	<footer class="footer">
		<div class="container">
			<div class="footer-meta">
				<div class="footer-links">
					{{{ footer_links }}}
				</div>
				<p>{{{ site_footer_copyright }}}</p>
			</div>
			</div>
	</footer>

    <div class="action action-style-0 action-color-0 action-pos-0">
        <div class="action-item gotop j-top">
            <i class="fal fa-arrow-up action-item-icon"></i>
        </div>
    </div>
    
    <div class="overlay" id="overlay"></div>
    
    <script src="{{ &OPT.theme_github_path }}JustNews/files/swiper.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const topButton = document.querySelector('.j-top');
            if(topButton) {
                topButton.addEventListener('click', function() {
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                });
            }
        });
    </script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const searchToggle = document.getElementById('search-toggle');
        const searchBox = document.getElementById('search-box');
        const closeSearchBtn = document.getElementById('close-search-btn');

        if (searchToggle && searchBox) {
            searchToggle.addEventListener('click', function(event) {
                event.stopPropagation();
                searchBox.classList.toggle('visible');
            });
            
            searchBox.addEventListener('click', function(event) {
                event.stopPropagation();
            });
        }

        if (closeSearchBtn) {
            closeSearchBtn.addEventListener('click', function() {
                searchBox.classList.remove('visible');
            });
        }
        
        document.addEventListener('click', function() {
            if (searchBox && searchBox.classList.contains('visible')) {
                searchBox.classList.remove('visible');
            }
        });

        const menuToggle = document.getElementById('mobile-menu-toggle');
        const mainNav = document.getElementById('main-nav');
        const body = document.querySelector('body');
        const overlay = document.getElementById('overlay');
        const closeMenuBtn = document.getElementById('close-menu-btn');

        const openMenu = function() { body.classList.add('nav-open'); };
        const closeMenu = function() { body.classList.remove('nav-open'); };
        
        if (menuToggle) { menuToggle.addEventListener('click', function(event) { event.stopPropagation(); openMenu(); }); }
        if (overlay) { overlay.addEventListener('click', closeMenu); }
        if (closeMenuBtn) { closeMenuBtn.addEventListener('click', closeMenu); }
        mainNav.addEventListener('click', function(event){ event.stopPropagation(); });

        const submenuToggles = document.querySelectorAll('.main-nav .submenu-toggle');
        submenuToggles.forEach(toggle => {
            toggle.addEventListener('click', function() {
                this.classList.toggle('active');
                const subMenu = this.nextElementSibling;
                if (subMenu && subMenu.classList.contains('sub-menu')) {
                    subMenu.classList.toggle('open');
                }
            });
        });
    });
</script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    if (window.innerWidth <= 990) {
        return;
    }

    const rightColumn = document.querySelector('.right-column');
    const sidebarWrapper = document.querySelector('.sidebar-sticky-wrapper');
    const leftColumn = document.querySelector('.left-column');
    const mainLayout = document.querySelector('.main-layout');

    if (!sidebarWrapper || !leftColumn || !mainLayout) {
        return;
    }

    const headerHeight = document.querySelector('.site-header').offsetHeight;
    const sidebarWrapperWidth = sidebarWrapper.offsetWidth;
    const mainLayoutTop = mainLayout.offsetTop;

    window.addEventListener('scroll', function() {
        const scrollTop = window.scrollY || document.documentElement.scrollTop;
        const viewportHeight = window.innerHeight;
        
        const mainLayoutHeight = mainLayout.offsetHeight;
        const sidebarWrapperHeight = sidebarWrapper.offsetHeight;

        const startStickPoint = mainLayoutTop - headerHeight;
        
        const stopStickPoint = mainLayoutTop + mainLayoutHeight - sidebarWrapperHeight - headerHeight;

        if (scrollTop > startStickPoint) {
            if (scrollTop < stopStickPoint) {
                sidebarWrapper.classList.add('sidebar-fixed');
                sidebarWrapper.classList.remove('sidebar-absolute-bottom');
                sidebarWrapper.style.width = sidebarWrapperWidth + 'px';
            } else {
                sidebarWrapper.classList.remove('sidebar-fixed');
                sidebarWrapper.classList.add('sidebar-absolute-bottom');
                sidebarWrapper.style.width = '100%';
            }
        } else {
            sidebarWrapper.classList.remove('sidebar-fixed');
            sidebarWrapper.classList.remove('sidebar-absolute-bottom');
            sidebarWrapper.style.width = '100%';
        }
    }, { passive: true });
});
</script>

</body>
</html>
